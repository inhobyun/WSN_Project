{% extends "m_base.html" %}

{% block foot %}
    <div style="color:#fff;">Push [Draw Graph] button to draw time-series graph...</div>
{% endblock %}

{% block left %}
    <div style="text-align:center;"><label><b>Graph X & Y Axis Setting</b></label></div><br> 
    <div style="text-align:right;"><button class="button-l" id="btn_draw" onclick="dispGraph('blue')"><b> Draw Graph </b></button></div>
    
    <div style="position:absolute; left:  8px; top:128px;"><label>Scaling Mode:</label></div>
    <div style="position:absolute; left:100px; top:128px;"><input type="radio" id="scale_auto" name="scale" onchange="clearScale()" value="scale_auto" checked>
                                                           <label>Automatic</label></div>
    <div style="position:absolute; left:100px; top:146px;"><input type="radio" id="scale_manu" name="scale" onchange="clearScale()" value="scale_manu" disabled>
                                                           <label>Manual</label></div>
    
    <div style="position:absolute; left: 16px; top:172px;"><label>Y (g)</label></div>
    <div style="position:absolute; left: 70px; top:172px;"><label for="y_min">Min</label></div>
    <div style="position:absolute; left:102px; top:170px;"><input type="number" id="y_min" value=''></div>
    <div style="position:absolute; left: 70px; top:202px;"><label for="y_max">Max</label></div>
    <div style="position:absolute; left:102px; top:200px;"><input type="number" id="y_max" value=''></div>   
    <div style="position:absolute; left: 70px; top:232px;"><label for="y_grid">Grid</label></div>
    <div style="position:absolute; left:102px; top:230Px;"><input type="number" id="y_grid" value='' disabled></div>
    
    <div style="position:absolute; left: 16px; top:272px;"><label>X (sec)</label></div>
    <div style="position:absolute; left: 70px; top:272px;"><label>Min</label></div>
    <div style="position:absolute; left:102px; top:270px;"><input type="number" id="x_min" value=''></div>  
    <div style="position:absolute; left: 70px; top:302px;"><label>Max</label></div>
    <div style="position:absolute; left:102px; top:300px;"><input type="number" id="x_max" value=''></div>
    <div style="position:absolute; left: 70px; top:332px;"><label>Grid</label></div>
    <div style="position:absolute; left:102px; top:330px;"><input type="number" id="x_grid" value='' disabled></div>
  
    <div style="position:absolute; left:  8px; top:370px;"><label>Draw Mode:</label></div>
    <div style="position:absolute; left:100px; top:370px;"><input type="radio" id="draw_s" name="draw" value="Sum(X,Y,Z)" checked>
                                                           <label>Sum of all direction</label></div>
    <div style="position:absolute; left:100px; top:388px;"><input type="radio" id="draw_x" name="draw" value="X only">
                                                           <label>X direction only</label></div>
    <div style="position:absolute; left:100px; top:406px;"><input type="radio" id="draw_y" name="draw" value="Y only">
                                                           <label>Y direction only</label></div>
    <div style="position:absolute; left:100px; top:424px;"><input type="radio" id="draw_z" name="draw" value="Z only">
                                                           <label>Z direction only</label></div>
{% endblock %}

{% block right %}

<div style="text-align:left"><b>Accelerometer Sensor Data - Time Series Graph</b></div>
<div style="text-align:left">
    <label id="time_label"></label>Measured Time : </label>
    <label id="time_stamp" style="font-weight:bold; color:blueviolet;"></label>
    
    <label id="freq_label"></label>, Frequency : </label>
    <label id="freq_stamp" style="font-weight:bold; color:blueviolet;"></label>
    
    <label id="mode_label"></label>, Draw Mode : </label>
    <label id="mode_stamp" style="font-weight:bold; color:blueviolet;"></label>
</div> 

<div class="form">
    <div id="chart-box"></div>
</div>

<script>
    function dispGraph(color_val) {
            document.getElementById("btn_draw").disabled = true;
            // drawing option
            var r_btn = document.getElementsByName("draw");
            var i, value;
            for (i = 0; i < r_btn.length; i++) {
                if ( r_btn[i].checked ) {
                    value = r_btn[i].value;
                }
            }    
            axios.post('/post_graphTime', {
                value: value,
            }).then(response => {
                const data = response.data;
                // drawing
                drawGraph(data, color_val,
                    document.getElementById("y_min"),
                    document.getElementById("y_max"),
                    document.getElementById("x_min"),
                    document.getElementById("x_max")
                );
                document.getElementById("time_stamp").innerHTML = data.t
                document.getElementById("freq_stamp").innerHTML = data.f
                document.getElementById("mode_stamp").innerHTML = data.m
                document.getElementById("btn_draw").disabled = false;
                document.getElementById("scale_manu").disabled = false;
                document.getElementById("scale_manu").checked = true;
            }).catch(function (error) {
                alert('Error occurred on submit: ' + error);
            });            
        }

        function clearScale() {
            if ( ! document.getElementById("scale_manu").checked ) {
                document.getElementById("y_min").value = '';
                document.getElementById("y_max").value = '';
                document.getElementById("x_min").value = '';
                document.getElementById("x_max").value = '';
            }
        }    
</script>    

{% endblock %}